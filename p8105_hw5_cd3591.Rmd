---
title: "p8105_hw5_cd3591"
author: "Anny"
date: "2025-11-07"
output: github_document
---

```{r}
# set up libraries
library("tidyverse")
```

# Problem 1
```{r}
# Write a function to check whether there are duplicate birthdays in the group; and return TRUE or FALSE based on the result.
birthday_shared = function(n_people){
  birthdays = sample(1:365, n_people, replace = TRUE)
  any(duplicated(birthdays))
}

# simulate 10000 times and calculate the prob
set.seed(1122)
birthday_sim_results =
  tibble(n_people = 2:50) %>% # for each group size between 2 and 50
  mutate(
    prob_shared = map_dbl(n_people,
      ~ mean(replicate(10000, birthday_shared(.x))) # run this function 10000 times & averaging across the 10000 simulation runs
    )
  )

birthday_sim_results

# make a plot
birthday_sim_results %>%
  ggplot(aes(x = n_people, y = prob_shared)) +
  geom_line() +
  geom_point() +
  labs(
    x = "Group size",
    y = "Estimated P(at least one shared birthday)",
    title = "Birthday problem simulation (10,000 runs per n_people)"
  ) +
  theme_minimal()

```

**Comments**: The plot and table show that the probability of at least one shared birthday is essentially zero for very small groups, but increases rapidly as `n_people` increases. In specific, when `n_people` = 23, the estimated probability is about 0.50, meaning a shared birthday is already more likely than not. By `n_people` = 35, the probability exceeds 0.80, and by `n_people` = 45 it is above 0.94; at `n_people` = 50, the probability is roughly 0.97. This indicates that even though there are 365 possible birthdays, only a relatively small group is needed for a high likelihood of shared birthdays.


